# `kpi_inclusion_list_compact.jsonc` 파일 사용 가이드

이 문서는 `kpi_inclusion_list_compact.jsonc` 파일의 새로운 기능인 `excluded_specs`와 `spec_units`를 사용하여 KPI 크롤링을 보다 세밀하게 제어하는 방법을 설명합니다.

## 1. `kpi_inclusion_list_compact.jsonc` 파일의 목적

`kpi_inclusion_list_compact.jsonc` 파일은 KPI 크롤러가 어떤 품목(대분류, 중분류, 소분류)을 크롤링할지, 그리고 각 품목에 어떤 단위를 적용할지를 정의하는 설정 파일입니다. 이 파일을 통해 크롤링 대상과 단위 정보를 중앙에서 관리할 수 있습니다.

## 2. `excluded_specs`: 특정 규격 크롤링에서 제외하기

특정 소분류 내에서 원하지 않는 규격(SPECIFICATION)이 있을 경우, `excluded_specs` 키를 사용하여 해당 규격을 크롤링 대상에서 제외할 수 있습니다. 이 목록에 포함된 규격은 크롤링 과정에서 완전히 무시되어 수집되지 않습니다.

### 사용 방법

`excluded_specs`는 소분류 레벨에서 배열 형태로 정의되며, 제외하고자 하는 규격명을 문자열로 추가합니다.

### 예시

예를 들어, `I형강` 소분류에서 "광산용I형강(GI-BEAM)(KSE4002) - A130×B100×t₁12.0×t₂17.0 단중35.00㎏/m" 규격을 제외하고 싶다면 다음과 같이 설정합니다.

```json
{
  "철강": {
    "형강": {
      "I형강": {
        "unit": "ton",
        "excluded_specs": [
          "광산용I형강(GI-BEAM)(KSE4002) - A130×B100×t₁12.0×t₂17.0 단중35.00㎏/m"
        ]
      }
    }
  }
}
```

위 설정은 `I형강` 소분류의 모든 규격을 `ton` 단위로 크롤링하지만, `excluded_specs`에 명시된 규격은 건너뛰게 됩니다.

## 3. `spec_units`: 규격별 단위 지정하기

특정 소분류 내에서 각 규격마다 다른 단위를 적용하고 싶을 경우, `spec_units` 키를 사용하여 규격별로 단위를 지정할 수 있습니다. 이는 소분류에 공통 단위(`unit` 키)가 지정되어 있더라도, 특정 규격에 대해 해당 공통 단위를 재정의하여 다른 단위를 적용할 수 있게 합니다.

### 사용 방법

`spec_units`는 소분류 레벨에서 객체 형태로 정의되며, 키(key)는 규격명, 값(value)은 해당 규격에 적용할 단위 문자열이 됩니다.

### 예시

예를 들어, `I형강` 소분류에서 특정 규격은 `ton`으로, 다른 규격은 `m`으로 단위를 지정하고 싶다면 다음과 같이 설정합니다.

```json
{
  "철강": {
    "형강": {
      "I형강": {
        "unit": "kg", // I형강 소분류의 기본 단위
        "spec_units": {
          "일반I형강(SS275) - 100×50×5×7 단중9.46㎏/m": "ton", // 이 규격은 ton 단위 적용
          "일반I형강(SS275) - 150×75×5.5×10 단중17.00㎏/m": "m" // 이 규격은 m 단위 적용
        }
      }
    }
  }
}
```

위 설정은 `I형강` 소분류의 기본 단위를 `kg`으로 지정합니다. 하지만 `spec_units`에 명시된 규격들은 각각 `ton`과 `m` 단위를 따르게 됩니다. `spec_units`에 명시되지 않은 다른 `I형강` 규격들은 `unit` 키에 정의된 `kg` 단위를 따르게 됩니다.

## 4. 단위 결정 우선순위

단위는 다음 우선순위에 따라 결정됩니다 (높은 순서부터):

1.  **`spec_units`**: 특정 규격에 직접 지정된 단위
2.  **`unit`**: 소분류 레벨에 지정된 기본 단위
3.  **`specifications`**: (기존 로직) 규격 목록 내에 단위가 포함된 경우
4.  **`default`**: (기존 로직) 최하위 레벨에 `default` 키로 지정된 단위

`excluded_specs`에 포함된 규격은 단위 결정 로직 이전에 크롤링 대상에서 제외됩니다.

## 5. `excluded_specs`와 `spec_units` 함께 사용하기

`excluded_specs`와 `spec_units`는 같은 소분류 레벨에서 함께 사용할 수 있습니다. 특정 규격은 크롤링에서 제외하고, 나머지 규격 중 일부에는 개별 단위를 지정하며, 그 외 규격에는 기본 단위를 적용하는 시나리오에서 유용합니다.

### 예시

예를 들어, `I형강` 소분류에서 특정 규격은 제외하고, 다른 특정 규격에는 `ton` 단위를, 또 다른 규격에는 `m` 단위를 지정하며, 나머지 규격에는 `kg` 단위를 적용하고 싶다면 다음과 같이 설정합니다.

```json
{
  "철강": {
    "형강": {
      "I형강": {
        "unit": "kg", // I형강 소분류의 기본 단위
        "excluded_specs": [
          "광산용I형강(GI-BEAM)(KSE4002) - A130×B100×t₁12.0×t₂17.0 단중35.00㎏/m" // 이 규격은 크롤링에서 제외
        ],
        "spec_units": {
          "일반I형강(SS275) - 100×50×5×7 단중9.46㎏/m": "ton", // 이 규격은 ton 단위 적용
          "일반I형강(SS275) - 150×75×5.5×10 단중17.00㎏/m": "m" // 이 규격은 m 단위 적용
        }
      }
    }
  }
}
```

위 설정은 `광산용I형강...` 규격은 크롤링에서 제외하고, `일반I형강(SS275) - 100×50×5×7 단중9.46㎏/m` 규격에는 `ton` 단위를, `일반I형강(SS275) - 150×75×5.5×10 단중17.00㎏/m` 규격에는 `m` 단위를 적용합니다. `excluded_specs`와 `spec_units`에 명시되지 않은 다른 `I형강` 규격들은 `unit` 키에 정의된 `kg` 단위를 따르게 됩니다.

이 가이드를 통해 `kpi_inclusion_list_compact.jsonc` 파일을 효과적으로 활용하여 KPI 크롤링을 관리하시길 바랍니다.